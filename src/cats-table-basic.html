<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-data-table/iron-data-table.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<dom-module id="cats-table-basic">

  <template>

    <style>
      :host {
        display: block;
      }
      .thumb {
        height: 64px;
        width: 64px;
      }
      .pop {
        height: 100%;
        width:  100%;
      }
      iron-data-table {
         @apply(--layout-horizontal);
      }      
    </style>

    <!-- <p>Basic cloud categories</p> -->

    <template is="dom-if" if="{{countclasses(categories)}}">
      
      <!-- <p>Select from ([[countclasses(categories)]]) cloud-categories</p> -->
  
      <paper-dialog 
          id="fullpop" 
          alwaysOnTop 
          entry-animation="scale-up-animation"
          exit-animation="fade-out-animation"><!--  modal> -->
        <iron-image id="fullimage" class="pop" src="[[fullsrc]]">
        </iron-image>
        <p id="fulltext"></p>
        <div class="buttons">
          <paper-button dialog-confirm autofocus>Tap me to close</paper-button>
        </div>
      </paper-dialog>
      

      <iron-data-table selection-enabled multi-selection items="[[categories]]">
      <!-- <iron-data-table selection-enabled items="[[categories]]"> -->
      <!-- <iron-data-table items="[[categories]]"> -->
      
        <data-table-column name="Sz" width="15px">
          <template>[[item.id]]</template>
        </data-table-column>

        <data-table-column name="Samples" width="50px">
          <template>
            <!-- <a href="[[item.sample]]" target="_blank"> -->
            <!-- <paper-button onclick="showImage([[item.sample]])" raised> -->
            <paper-button on-tap="showImage" raised>
              <iron-image sizing="cover" class="thumb" src="[[item.sample]]">
              </iron-image>
            </paper-button>
            <!-- </a> -->
          </template>
        </data-table-column>
        
        <data-table-column name="Category" width="100px">
          <template>[[item.name]]</template>
        </data-table-column>
        
        <data-table-column name="Abbr." width="30px">
          <template>[[item.abbr]]</template>
        </data-table-column>
        
        <data-table-column name="Symbol" width="30px">
          <template>
            <img src="[[item.symbol]]">
          </template>
        </data-table-column>
      
      </iron-data-table>

    </template>


  </template>

  <script>

    Polymer({

      is: 'cats-table-basic',

      properties: {
        
        data: Object,  

        categories: {
          computed: 'getclasses(data)',
          notify: true
        },

        fullsrc : ""
      },

      getclasses: function(data) { // console.log("raw data to view", data);
        if (!Array.isArray(data)) { // transform object to array
          var dataArray = new Array;
          for(var o in data) { dataArray.push(data[o]); }
          data = dataArray;          
        }  // console.log("processing categories-array:", data);
        return data;
      },
      countclasses: function(data) { 
        const len = data.length; // console.log("length of data-array:", len);
        return len;
      },
      showImage: function(e,b) {
        var src = Polymer.dom(e).path[2].src; // ABGEZAEHLT !!aus path-log
        var e1  = Polymer.dom(this.root).querySelector('#fullimage');
        var e2  = Polymer.dom(this.root).querySelector('#fullpop');
        var e3  = Polymer.dom(this.root).querySelector('#fulltext');
        this.fullsrc = src; // console.log("src=",src, e1, e2, e3);
        e3.innerText = src;
        e2.open();
      }

    });
  </script>
</dom-module>